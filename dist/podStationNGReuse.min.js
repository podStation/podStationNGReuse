function parsePodcastFeed(e){function t(e){return e.replace("GTM","GMT")}var i,n="string"==typeof e?$.parseXML(e):e,s=$(n);return s.find("rss > channel")[0]?(i={},i.podcast={},i.episodes=[],i.podcast.title=s.find("rss > channel > title").text(),i.podcast.description=function(e){var t="",i=[];return e.each(function(){var e=$(this);i.indexOf(e.text())<0&&(t&&(t+="<br>"),t+=e.text(),i.push(e.text()))}),t}(s.find("rss > channel > description")),i.podcast.link=s.find("rss > channel > link").text(),i.podcast.pubDate=t(s.find("rss > channel > pubDate").text())||t(s.find("rss > channel > lastBuildDate").text()),i.podcast.image=$(s.find("rss > channel > image > url")[0]).text()||s.find("rss > channel > image").attr("href")||s.find("rss > channel > itunes\\:image").attr("href"),s.find("rss > channel > item").each(function(){var e,n=$(this),s={};s.title=$(n.find("title")[0]).text(),s.link=n.find("link").text(),s.pubDate=t(n.find("pubDate").text()),s.parsedPubDate=new Date(s.pubDate),s.description=n.find("description").text(),s.guid=n.find("guid").text(),e=n.find("enclosure"),s.enclosure={url:e.attr("url"),length:e.attr("length"),type:e.attr("type")},i.episodes.push(s)}),i.episodes.sort(function(e,t){return t.parsedPubDate-e.parsedPubDate}),i.episodes[0]&&i.episodes[0].pubDate&&(void 0===i.podcast.pubDate||""===i.podcast.pubDate||new Date(i.episodes[0].pubDate)>new Date(i.podcast.pubDate))&&(i.podcast.pubDate=i.episodes[0].pubDate),i):i}angular.module("podStationReusables",[]),function(){"use strict";function e(){return{parseRSSFeed:parsePodcastFeed}}angular.module("podStationReusables").factory("feedParserService",e)}(),function(){"use strict";function e(e,t){function i(e,t){var i=t.find(function(t){return t.feedUrl===e.feedUrl});i?i.merge(e):t.push(e)}function n(t,n){var s=[],r=!1,c=!1;e.get("http://api.digitalpodcast.com/v2r/search/",{params:{appid:"0f56b00cfbdc051c29b88171e67507f3",format:"rssopml",keywords:t}}).then(function(e){$($.parseXML(e.data)).find("opml > body > outline").each(function(){var e=$(this),t=new a;t.title=e.attr("text"),t.description=e.attr("description"),t.link=e.attr("htmlUrl"),t.feedUrl=e.attr("xmlUrl"),t.subscribed=!1,i(t,s)}),n("resultAvailable",s)}).finally(function(){(r=!0)&&c&&n("searchFinished")}),e.get("https://itunes.apple.com/search",{params:{media:"podcast",term:t}}).then(function(e){e.data.results.forEach(function(e){var t=new a;t.title=e.collectionName,t.itunesLink=e.collectionViewUrl,t.feedUrl=e.feedUrl,t.subscribed=!1,t.image=e.artworkUrl100,i(t,s)}),n("resultAvailable",s)}).finally(function(){c=!0,r&&c&&n("searchFinished")})}var s={search:n},a=function(){return this.title="",this.feedUrl="",this.description="",this.link="",this.itunesLink="",this.image="",this.merge=function(e){""!==e.description&&(this.description=e.description),""!==e.link&&(this.link=e.link),""!==e.image&&(this.image=e.image),""!==e.itunesLink&&(this.itunesLink=e.itunesLink)},this};return s}angular.module("podStationReusables").factory("searchService",["$http","$q",e])}();